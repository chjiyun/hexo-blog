document.addEventListener("DOMContentLoaded",()=>{for(var t=document.querySelectorAll("#blog_value_page_pv"),n=document.querySelector("#blog_value_site_uv"),r=document.querySelector("#blog_value_site_pv"),e=[],o=_util.extractPostId(),i=0;i<t.length;i++){var a=t[i].dataset.postLink;a&&e.push(a)}var l=_util.querystring({linkUrl:e});CONFIG.page.isHome&&_util.http("/api/site-traffic/pvs?"+l).then(e=>{0===e.code?_util.renderCount(t,e.data):console.warn(e)}),o&&(l=_util.parseUa(),_util.http("/api/site-traffic",{method:"POST",body:{linkUrl:o,...l}}).then(e=>{0===e.code&&(r.innerHTML=e.data.sitePv,n.innerHTML=e.data.siteUv,e=[{linkUrl:o,pv:e.data.pv}],_util.renderCount(t,e))}))}),function(){"use strict";window._util||(window._util=Object.create({renderCount:function(e,r){r&&0!==r.length&&e.forEach(e=>{var t=e.dataset.postLink,n=r.find(e=>e.linkUrl===t);n&&(e.innerHTML=n&&n.pv||0)})},querystring:function(n){if(!n)return"";let r="";return Object.keys(n).forEach(t=>{var e=n[t];null!=e&&(e instanceof Array?r+=e.map(e=>t+"="+e).join("&"):e instanceof Object?r+=e.toString():r+=e)}),r},extractPostId:function(){var e=location.pathname;return"/"===e?e:CONFIG.page.isPost?e.replace(/^\/p\//,"").replace(/\.html$/,""):decodeURIComponent(e.replace(/\/$/,""))},http:function(e="",t={}){var n=t.body&&JSON.stringify(t.body)||null;return fetch(location.origin+e,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8"},...t,body:n}).then(e=>e.json())},parseUa:function(){var e=[(n=(new UAParser).getResult()).browser.name,n.browser.version],t=[n.os.name,n.os.version],n=[n.os.vendor,n.os.model];return{browser:e.filter(e=>e).join(" "),os:t.filter(e=>e).join(" "),device:n.filter(e=>e).join(" ")}}}))}();